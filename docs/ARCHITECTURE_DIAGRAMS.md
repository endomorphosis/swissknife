# SwissKnife Architecture Diagrams

This document provides visual representations of the SwissKnife unified architecture, illustrating the relationships between domains and the overall system structure.

## Domain Relationships Diagram

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                 CLI Domain                                  │
│                                                                             │
│  ┌───────────────┐   ┌───────────────┐   ┌───────────────┐   ┌───────────┐  │
│  │ Command       │   │ UI            │   │ Formatters    │   │ Shell     │  │
│  │ System        │   │ Components    │   │               │   │           │  │
│  └─────┬─────────┘   └───────────────┘   └───────────────┘   └───────────┘  │
└─────────┼─────────────────────┬─────────────────────┬───────────────────────┘
          │                     │                     │
┌─────────▼─────────┐ ┌─────────▼─────────┐ ┌─────────▼─────────────────────┐
│    AI Domain      │ │    ML Domain      │ │        Tasks Domain           │
│                   │ │                   │ │                               │
│ ┌───────────────┐ │ │ ┌───────────────┐ │ │ ┌────────────┐ ┌────────────┐ │
│ │ Agent         │ │ │ │ Tensor        │ │ │ │ Scheduler  │ │ Graph of   │ │
│ │ System        │◄┼─┼─┤ Operations    │ │ │ │            │ │ Thought    │ │
│ └───────┬───────┘ │ │ └───────┬───────┘ │ │ └──────┬─────┘ └─────┬──────┘ │
│         │         │ │         │         │ │        │             │        │
│ ┌───────▼───────┐ │ │ ┌───────▼───────┐ │ │ ┌──────▼─────┐ ┌─────▼──────┐ │
│ │ Tool          │ │ │ │ Hardware      │ │ │ │ Task       │ │ Decomposer │ │
│ │ System        │◄┼─┼─┤ Acceleration  │ │ │ │ Manager    │ │            │ │
│ └───────┬───────┘ │ │ └───────┬───────┘ │ │ └──────┬─────┘ └─────┬──────┘ │
│         │         │ │         │         │ │        │             │        │
│ ┌───────▼───────┐ │ │ ┌───────▼───────┐ │ │ ┌──────▼─────┐ ┌─────▼──────┐ │
│ │ Model         │ │ │ │ Inference     │ │ │ │ Task       │ │ Delegation │ │
│ │ System        │◄┼─┼─┤ Engine        │ │ │ │ Queue      │ │ System     │ │
│ └───────┬───────┘ │ │ └───────────────┘ │ │ └────────────┘ └────────────┘ │
│         │         │ │                   │ │                               │
└─────────┼─────────┘ └───────┬───────────┘ └────────────────┬──────────────┘
          │                   │                              │
          │                   │                              │
┌─────────▼───────────────────▼──────────────────────────────▼───────────────┐
│                             Storage Domain                                 │
│                                                                            │
│     ┌───────────────┐   ┌───────────────┐   ┌───────────────────────┐      │
│     │ Local         │   │ Caching       │   │ IPFS Integration      │      │
│     │ Storage       │   │ System        │   │                       │      │
│     └───────────────┘   └───────────────┘   └───────────┬───────────┘      │
│                                                         │                  │
└─────────────────────────────────────────────────────────┼──────────────────┘
                                                          │
                                           API Communication
                                                          │
┌─────────────────────────────────────────────────────────▼──────────────────┐
│                        IPFS Kit MCP Server (Python)                        │
│                                                                            │
│  ┌───────────────┐   ┌───────────────┐   ┌───────────────┐   ┌──────────┐  │
│  │ MCP Model     │   │ MCP Control   │   │ MCP Persist   │   │ Storage  │  │
│  │ Layer         │   │ Layer         │   │ Layer         │   │ Backend  │  │
│  └───────────────┘   └───────────────┘   └───────────────┘   └──────────┘  │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
```

## Component Interaction Flow

```
┌───────────┐       ┌───────────┐       ┌───────────┐       ┌───────────┐
│  Command  │       │  Agent    │       │  Tool     │       │  Storage  │
│  System   │       │  System   │       │  System   │       │  System   │
└─────┬─────┘       └─────┬─────┘       └─────┬─────┘       └─────┬─────┘
      │                   │                   │                   │
      │ Execute command   │                   │                   │
      ├──────────────────►│                   │                   │
      │                   │                   │                   │
      │                   │ Process message   │                   │
      │                   ├───────────┐       │                   │
      │                   │           │       │                   │
      │                   │◄──────────┘       │                   │
      │                   │                   │                   │
      │                   │ Execute tool      │                   │
      │                   ├───────────────────►                   │
      │                   │                   │                   │
      │                   │                   │ Store result      │
      │                   │                   ├───────────────────►
      │                   │                   │                   │
      │                   │                   │◄───────────────────
      │                   │                   │ Return CID        │
      │                   │◄───────────────────                   │
      │                   │ Tool result       │                   │
      │                   │                   │                   │
      │◄──────────────────┤                   │                   │
      │ Command result    │                   │                   │
      │                   │                   │                   │
```

## Data Flow Diagram

```
┌────────────────────────────────────────────────────────────────────────┐
│                               SwissKnife                               │
│                                                                        │
│  ┌───────────┐     ┌───────────┐     ┌───────────┐     ┌───────────┐   │
│  │   CLI     │────►│ Commands  │────►│  Domain   │────►│ TypeScript│   │
│  │  Input    │     │ Parser    │     │ Services  │     │ Execution │   │
│  └───────────┘     └───────────┘     └───────────┘     └───────────┘   │
│         ▲                                                    │         │
│         │                                                    │         │
│         │           ┌───────────┐     ┌───────────┐          │         │
│         └───────────┤ Formatted │◄────┤   Data    │◄─────────┘         │
│                     │  Output   │     │ Processing│                    │
│                     └───────────┘     └───────────┘                    │
│                                                                        │
└───────────────────────────────┬────────────────────────────────────────┘
                                │
                                │ API Communication
                                │
┌───────────────────────────────▼──────────────────────────────────────────┐
│                        IPFS Kit MCP Server                               │
│                                                                          │
│ ┌───────────┐    ┌───────────┐    ┌───────────┐    ┌───────────────┐     │
│ │   HTTP    │◄──►│    MCP    │◄──►│  Content  │◄──►│ IPFS / Local  │     │
│ │   API     │    │ Processor │    │ Management│    │   Storage     │     │
│ └───────────┘    └───────────┘    └───────────┘    └───────────────┘     │
│                                                                          │
└──────────────────────────────────────────────────────────────────────────┘
```

## Layered Architecture Diagram

```
┌────────────────────────────────────────────────────────────────────────┐
│                         Presentation Layer                             │
│                                                                        │
│  ┌────────────────────┐   ┌────────────────────┐   ┌────────────────┐  │
│  │    CLI Commands    │   │  Terminal UI       │   │ Web Interface  │  │
│  └────────────────────┘   └────────────────────┘   └────────────────┘  │
└─────────────────────────────────┬──────────────────────────────────────┘
                                  │
┌─────────────────────────────────▼──────────────────────────────────────┐
│                         Application Layer                              │
│                                                                        │
│  ┌─────────────┐   ┌─────────────┐   ┌─────────────┐   ┌─────────────┐ │
│  │  AI Agents  │   │  ML Models  │   │Task Manager │   │Configuration│ │
│  └─────────────┘   └─────────────┘   └─────────────┘   └─────────────┘ │
└─────────────────────────────────┬──────────────────────────────────────┘
                                  │
┌─────────────────────────────────▼───────────────────────────────────────┐
│                          Domain Layer                                   │
│                                                                         │
│  ┌─────────────┐   ┌─────────────┐   ┌─────────────┐   ┌──────────────┐ │
│  │  AI Domain  │   │  ML Domain  │   │Tasks Domain │   │Storage Domain│ │
│  └─────────────┘   └─────────────┘   └─────────────┘   └──────────────┘ │
└─────────────────────────────────┬───────────────────────────────────────┘
                                  │
┌─────────────────────────────────▼───────────────────────────────────────┐
│                       Infrastructure Layer                              │
│                                                                         │
│  ┌─────────────┐   ┌──────────────┐   ┌─────────────┐   ┌─────────────┐ │
│  │  TypeScript │   │Worker Threads│   │  Local DB   │   │IPFS Kit MCP │ │
│  │   Runtime   │   │    Pool      │   │    Cache    │   │  Client     │ │
│  └─────────────┘   └──────────────┘   └─────────────┘   └─────────────┘ │
└────────────────────────────────────────────────┬────────────────────────┘
                                                 │
┌────────────────────────────────────────────────▼───────────────────────┐
│                        External Services                               │
│                                                                        │
│  ┌─────────────────┐   ┌─────────────────┐   ┌──────────────────────┐  │
│  │  IPFS Kit MCP   │   │   AI Model      │   │  External Storage    │  │
│  │    Server       │   │   Providers     │   │     Services         │  │
│  └─────────────────┘   └─────────────────┘   └──────────────────────┘  │
└────────────────────────────────────────────────────────────────────────┘
```

## AI Agent System Architecture

```
┌──────────────────────────────────────────────────────────────────────────┐
│                            AI Agent System                               │
│                                                                          │
│  ┌──────────────────────────────────────────────────────────────────┐    │
│  │                     Agent Implementation                         │    │
│  │                                                                  │    │
│  │  ┌───────────────┐    ┌──────────────┐    ┌───────────────────┐  │    │
│  │  │ Input/Output  │    │ Message      │    │ Context           │  │    │
│  │  │ Handler       │◄──►│ Management   │◄──►│ Management        │  │    │
│  │  └───────┬───────┘    └──────┬───────┘    └──────────┬────────┘  │    │
│  │          │                  │                      │             │    │
│  │          └──────────────────▼──────────────────────┘             │    │
│  │                             │                                    │    │
│  │                    ┌────────▼─────────┐                          │    │
│  │                    │  Thinking Engine │                          │    │
│  │                    └────────┬─────────┘                          │    │
│  │                             │                                    │    │
│  └─────────────────────────────┼────────────────────────────────────┘    │
│                                │                                         │
│  ┌────────────────────────────┐│┌────────────────┐ ┌───────────────────┐ │
│  │      Tool System           │││  Model System  │ │  Thinking System  │ │
│  │                            │└─────────────────┘ └───────────────────┘ │
│  │  ┌───────────┐ ┌─────────┐ │      ┌──────────────┐  ┌──────────────┐  │
│  │  │ Tool      │ │ Tool    │ │      │ Model        │  │ Graph-of-    │  │
│  │  │ Registry  │ │ Executor│◄┼──┐   │ Registry     │  │ Thought      │  │
│  │  └───────────┘ └─────────┘ │  │   └──────────────┘  └──────────────┘  │
│  │  ┌───────────────────────┐ │  │   ┌──────────────┐  ┌──────────────┐  │
│  │  │ Built-in Tool         │ │  └───┤ Model        │  │ Reasoning    │  │
│  │  │ Implementation        │ │      │ Executor     │  │ Patterns     │  │
│  │  └───────────────────────┘ │      └──────────────┘  └──────────────┘  │
│  └────────────────────────────┘                                          │
└──────────────────────────────────────────────────────────────────────────┘
```

## Storage System Architecture

```
┌────────────────────────────────────────────────────────────────────────────┐
│                          Storage System                                    │
│                                                                            │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                     Storage Provider Interface                      │   │
│  │                                                                     │   │
│  │  ┌────────────┐    ┌────────────┐    ┌────────────┐   ┌────────────┐│   │
│  │  │  add()     │    │  get()     │    │  list()    │   │ delete()   ││   │
│  │  └────────────┘    └────────────┘    └────────────┘   └────────────┘│   │
│  └──────────┬───────────────┬─────────────────┬──────────────┬─────────┘   │
│             │               │                 │              │             │
│  ┌──────────▼───────┐ ┌─────▼────────┐  ┌──────▼─────────┐ ┌──▼───────────┐│
│  │  Local Storage   │ │ IPFS Storage │  │ Memory Storage │ │Remote Storage││
│  │  Implementation  │ │Implementation│  │ Implementation │ │Implementation││
│  └──────────────────┘ └──────────────┘  └────────────────┘ └──────────────┘│
│             │               │                                              │
│  ┌──────────▼───────┐ ┌─────▼─────────────────────────────────────┐        │
│  │     File System  │ │          MCP Client                       │        │
│  │     Operations   │ │                                           │        │
│  └──────────────────┘ │  ┌───────────┐   ┌─────────────────┐      │        │
│                       │  │ HTTP API  │   │ WebSocket API   │      │        │
│                       │  │ Client    │   │ Client          │      │        │
│                       │  └─────┬─────┘   └────────┬────────┘      │        │
│                       │        │                  │               │        │
│                       │  ┌─────▼──────────────────▼─────────┐     │        │
│                       │  │     Response Processing          │     │        │
│                       │  └──────────────────────────────────┘     │        │
│                       └───────────────────────────────────────────┘        │
│                                          │                                 │
└──────────────────────────────────────────┼─────────────────────────────────┘
                                           │
                        API Communication  │
                                           │
┌──────────────────────────────────────────▼──────────────────────────────┐
│                    IPFS Kit MCP Server (Python)                         │
└───────────────────────────────────────────────────────────────────────────┘
```

## ML Acceleration System Architecture

```
┌───────────────────────────────────────────────────────────────────────────┐
│                        ML Acceleration System                             │
│                                                                           │
│  ┌────────────────────────────────────────────────────────────────────┐   │
│  │                     Inference Engine                               │   │
│  │                                                                    │   │
│  │  ┌───────────────┐    ┌──────────────┐    ┌───────────────────┐    │   │
│  │  │ Model Loading │    │ Input/Output │    │ Execution         │    │   │
│  │  │ & Parsing     │◄──►│ Processing   │◄──►│ Orchestration     │    │   │
│  │  └───────────────┘    └──────────────┘    └─────────┬─────────┘    │   │
│  │                                                     │              │   │
│  └─────────────────────────────────────────────────────┼──────────────┘   │
│                                                        │                  │
│   ┌───────────────────┐  ┌────────────────┐  ┌─────────▼──────────┐       │
│   │  Tensor Operations│  │Hardware        │  │Optimizers          │       │
│   │                   │  │Accelerators    │  │                    │       │
│   │ ┌───────────────┐ │  │┌─────────────┐ │  │┌─────────────────┐ │       │
│   │ │ Tensor Data   │ │  ││ WebGPU      │ │  ││ Quantization    │ │       │
│   │ │ Structure     │ │  ││ Accelerator │ │  ││ Engine          │ │       │
│   │ └───────────────┘ │  │└─────────────┘ │  │└─────────────────┘ │       │
│   │ ┌───────────────┐ │  │┌─────────────┐ │  │┌─────────────────┐ │       │
│   │ │ Matrix        │ │  ││ WebNN       │ │  ││ Pruning         │ │       │
│   │ │ Operations    │ │◄─┼┤ Accelerator │◄┼──┼┤ Engine          │ │       │
│   │ └───────────────┘ │  │└─────────────┘ │  │└─────────────────┘ │       │
│   │ ┌───────────────┐ │  │┌─────────────┐ │  │┌─────────────────┐ │       │
│   │ │ Transformation│ │  ││ WebAssembly │ │  ││ Format          │ │       │
│   │ │ Functions     │ │  ││ Accelerator │ │  ││ Conversion      │ │       │
│   │ └───────────────┘ │  │└─────────────┘ │  │└─────────────────┘ │       │
│   └───────────────────┘  └────────────────┘  └────────────────────┘       │
└────────────────────────────────────────────────────────────────────────────┘
```

## Task System Architecture

```
┌───────────────────────────────────────────────────────────────────────────────┐
│                            Task System                                        │
│                                                                               │
│  ┌──────────────────────────────────────────────────────────────────────┐     │
│  │                       Task Manager                                   │     │
│  │                                                                      │     │
│  │  ┌───────────────┐    ┌──────────────┐     ┌───────────────────┐     │     │
│  │  │ Task Creation │    │ Status       │     │ Result            │     │     │
│  │  │ & Tracking    │◄──►│ Management   │◄───►│ Collection        │     │     │
│  │  └───────┬───────┘    └──────────────┘     └─────────┬─────────┘     │     │
│  │          │                                           │               │     │
│  └──────────┼───────────────────────────────────────────┼───────────────┘     │
│             │                                           │                     │
│  ┌──────────▼──────┐   ┌─────────────────┐   ┌─────────▼──────────┐           │
│  │    Scheduler    │   │  Decomposition  │   │ Delegation         │           │
│  │                 │   │  System         │   │ System             │           │
│  │ ┌─────────────┐ │   │ ┌─────────────┐ │   │ ┌───────────────┐  │           │
│  │ │ Fibonacci   │ │   │ │Graph-based  │ │   │ │Task Assignment│  │           │
│  │ │ Heap        │ │   │ │Decomposition│ │   │ │Algorithm      │  │           │
│  │ └─────────────┘ │   │ └─────────────┘ │   │ └───────────────┘  │           │
│  │ ┌─────────────┐ │   │ ┌─────────────┐ │   │ ┌───────────────┐  │           │
│  │ │Priority     │◄┼───┼►│Strategy     │◄┼───┼►│Load Balancing │  │           │
│  │ │Management   │ │   │ │Selection    │ │   │ │               │  │           │
│  │ └─────────────┘ │   │ └─────────────┘ │   │ └───────────────┘  │           │
│  │ ┌─────────────┐ │   │ ┌─────────────┐ │   │ ┌───────────────┐  │           │
│  │ │Dependency   │ │   │ │Result       │ │   │ │Failure        │  │           │
│  │ │Tracking     │ │   │ │Aggregation  │ │   │ │Recovery       │  │           │
│  │ └─────────────┘ │   │ └─────────────┘ │   │ └───────────────┘  │           │
│  └─────────────────┘   └─────────────────┘   └────────────────────┘           │
└───────────────────────────────────────────────────────────────────────────────┘
```

These diagrams provide visual representations of the SwissKnife unified architecture, illustrating the relationships between domains, data flow, component interactions, and detailed subsystem architectures.